<templates id="employee_evaluation_dashboard_templates" xml:space="preserve">
    <t t-name="qc_dashboard.UserKPIDashboard" owl="1">
        <div class="qctracker_dashboard_container1">
            <div class="qc_dashboard_flex">
               

                <!-- Dashboard Content -->
                <main class="qc_dashboard_content ">
                  <header class="qc_dashboard_header">
    <div class="qc_filter_container">
        <!-- Section 1 : Dates -->
        <div class="qc_filter_section">
            <label class="qc_filter_label">Espace Périodique</label>
            <div class="qc_date_filter_group">
                <input 
                    type="date" 
                    class="form-control qc_filter_select"
                    t-ref="dateFrom"
                    t-on-change="onDateFromChange"
                />
                <div class="qc_date_separator_container">
                    <span class="qc_date_separator">au</span>
                </div>
                <input 
                    type="date" 
                    class="form-control qc_filter_select"
                    t-ref="dateTo"
                    t-on-change="onDateToChange"
                />
            </div>
        </div>

        <!-- Section 2 : Département (si manager/admin) -->
        <t t-if="state.isManagerOrAdmin">
            <div class="qc_filter_section">
                <label class="qc_filter_label">Département</label>
                <select 
                    class="qc_filter_select"
                    t-model="state.selectedDepartmentId"
                    t-on-change="onDepartmentChange"  
                >
                    <option value="">Tous</option>
                    <option 
                        t-foreach="state.availableDepartments" 
                        t-as="dept"
                        t-key="dept.id"
                        t-att-value="dept.id"
                        t-esc="dept.name"
                    />
                </select>
            </div>

            <!-- Section 3 : Responsable -->
            <div class="qc_filter_section">
                <label class="qc_filter_label">Responsable</label>
                <select 
                    class="qc_filter_select"
                    t-model="state.selectedResponsibleId"
                    t-on-change="onResponsibleChange"
                >
                    <option value="">Tous</option>
                    <option 
                        t-foreach="state.employeesForDepartment" 
                        t-as="emp"
                        t-key="emp.id"
                        t-att-value="emp.id"
                        t-esc="emp.name"
                    />
                </select>
            </div>
        </t>
        
        <!-- Section 4 : Projet -->
        <div class="qc_filter_section">
            <label class="qc_filter_label">Projet</label>
            <select 
                class="qc_filter_select"
                t-model="state.selectedProjectId"
                t-on-change="onProjectChange"
            >
                <option value="">Tous</option>
                <option 
                    t-foreach="state.availableProjects" 
                    t-as="project"
                    t-key="project.id"
                    t-att-value="project.id"
                    t-esc="project.name"
                />
            </select>
        </div>
    </div>
    
    <!-- Profile utilisateur à droite -->
    <div class="header_right">
              <div class="qc_button_group">
            <button class="qc_apply_btn" t-on-click="onApplyFilters" t-att-disabled="state.loading">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
                Apply
            </button>
            <button class="qc_reset_btn" t-on-click="onResetFilters" t-att-disabled="state.loading">
                <i class="fa fa-refresh"></i>
                Reset
            </button>
        </div>
    </div>
</header>

                    
                    <section class="qc_content_grid">
                        <div class="p-6">
                            <h1 class="text-3xl font-bold mb-2">Dashboard</h1>
                            <p class="text-lg text-gray-600">Workprogramm Overview</p>
                        </div>
                         <div class="p-6">
        <div class="flex flex-wrap justify-between gap-6">
    <article class="flex-1 min-w-0 flex items-center gap-5 rounded-2xl border border-gray-200 bg-white p-4 shadow-md dark:border-gray-800 dark:bg-white/[0.03]">
    <div class="bg-[#A62424]/10 text-[#A62424] inline-flex h-16 w-16 items-center justify-center rounded-xl">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2z"></path>
        </svg>
    </div>
    <div>
        <h3 class="text-2xl font-semibold text-gray-800 dark:text-white/90">
           <t t-esc="state.totalProjects"/>
        </h3>
        <p class="text-gray-500 dark:text-gray-400">
            projets impliqués
        </p>
    </div>
</article>
            
            <article class=" kpi-card flex-1 min-w-0 flex items-center gap-5 rounded-2xl border border-gray-200 bg-white p-4 shadow-md dark:border-gray-800 dark:bg-white/[0.03] cursor-pointer" t-on-click="onAllTasksClick">
    <div class="bg-[#A62424]/10 text-[#A62424] inline-flex h-16 w-16 items-center justify-center rounded-xl">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm4 14H8v-2h8v2zm4-4H8v-2h12v2zm0-4H8V7h12v2z"></path>
        </svg>
    </div>
    <div>
        <h3 class="text-2xl font-semibold text-gray-800 dark:text-white/90">
            <t t-esc="state.totalTasks"/>
        </h3>
        <p class="text-gray-500 dark:text-gray-400">
           Nombre de Tâches
        </p>
    </div>
</article>
            
            <article class="kpi-card  flex-1 min-w-0 flex items-center gap-5 rounded-2xl border border-gray-200 bg-white p-4 shadow-md dark:border-gray-800 dark:bg-white/[0.03] cursor-pointer" t-on-click="onTasksValidatedClick">
    <div class="bg-[#A62424]/10 text-[#A62424] inline-flex h-16 w-16 items-center justify-center rounded-xl">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm-2 14l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"></path>
        </svg>
    </div>
    <div>
        <h3 class="text-2xl font-semibold text-gray-800 dark:text-white/90">
            <t t-esc="state.tasksValid"/>
        </h3>
        <p class="text-gray-500 dark:text-gray-400">
            Taches Valides
        </p>
    </div>
</article>
            
          <article class="kpi-card  flex-1 min-w-0 flex items-center gap-5 rounded-2xl cursor-pointer border border-gray-200 bg-white p-4 shadow-md dark:border-gray-800 dark:bg-white/[0.03]"  t-on-click="onTasksToValidateClick">
    <div class="bg-[#A62424]/10 text-[#A62424] inline-flex h-16 w-16 items-center justify-center rounded-xl">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm11.378-3.917c-.89-.777-2.366-.777-3.255 0a.75.75 0 0 1-.988-1.129c1.454-1.272 3.776-1.272 5.23 0 1.513 1.324 1.513 3.518 0 4.842a3.75 3.75 0 0 1-.837.552c-.676.328-1.028.774-1.028 1.152v.75a.75.75 0 0 1-1.5 0v-.75c0-1.279 1.06-2.107 1.875-2.502.373-.179.683-.386.879-.582.433-.434.433-1.159 0-1.593-.195-.196-.505-.402-.878-.582Z" clip-rule="evenodd" />
          </svg>
    </div>
    <div>
        <h3 class="text-2xl font-semibold text-gray-800 dark:text-white/90">
        <t t-esc="state.tasksToValid"/>
        </h3>
        <p class="text-gray-500 dark:text-gray-400">
            Taches a vailder 
        </p>
    </div>
</article>
        </div>
    </div>
    
     <div class="p-6">
    <div class="flex flex-col md:flex-row gap-6">
        
        <div class="w-full md:w-1/2">
            <div class="bg-white border  rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700 p-6">
                <div class="flex items-center justify-between mb-5">
                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white/90">
                        Répartition par tâches complexes
                    </h3>
                </div>

                <div class="flex justify-center items-center h-64  rounded-lg mb-6 text-gray-500 dark:bg-gray-700 dark:text-gray-400">
                    <div t-ref="complexity-distribution-chart" class="h-full w-full"></div>
                </div>
            </div>
        </div>

        <div class="w-full md:w-1/2">
            <div class="bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700 p-6">
                <div class="flex items-center justify-between mb-5">
                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white/90">
                        Répartition des tâches par priorité
                    </h3>
                </div>

                <div class="flex justify-center items-center h-64  rounded-lg mb-6 text-gray-500 dark:bg-gray-700 dark:text-gray-400">
                    <div t-ref="priority-distribution-chart" class="h-full w-full"></div>
                </div>
            </div>
        </div>
        
    </div>
</div>

<div class="p-6">
    <div class="bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700 p-3">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white/90">
                Répartition des tâches par état 
            </h3>
        </div>

        <div class="flex justify-center items-center h-custom-2
          rounded-lg text-gray-500 dark:bg-gray-700 dark:text-gray-400">
            <div t-ref="state-distribution-chart" class="h-full w-full"></div>
        </div>
    </div>
</div>
    <div class="p-6">
    <div class="bg-white shadow-md rounded-lg p-4 qc_table_height flex flex-col overflow-hidden">
        <h3 class="text-lg font-semibold text-gray-700 mb-2">Tableau des données</h3>
        
            <div t-ref="tasks-grid" class="flex-grow ag-theme-alpine" style="height: 100%; width: 100%;"/>
        
    </div>
</div>
                        
                  
                    </section>
                </main>
            </div>
        </div>
    </t>
</templates>